<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>{% block title %}–¢–æ—Ä–≥–æ–≤—ã–π –∂—É—Ä–Ω–∞–ª{% endblock %}</title>

  <!-- ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ CSS (—É—Å—Ç—Ä–∞–Ω—è–µ—Ç –±–µ–ª—É—é –≤—Å–ø—ã—à–∫—É) -->
<!-- ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ CSS -->
  <script>
    (function() {
  try {
    const theme = localStorage.getItem('theme');

    // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å—ã –Ω–∞–ø—Ä—è–º—É—é –∫ <html> –∏ <body>, –¥–∞–∂–µ –µ—Å–ª–∏ <body> –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
    if (theme === 'dark') {
      document.documentElement.classList.add('dark-mode-html');
      // –ï—Å–ª–∏ <body> —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî —Å—Ä–∞–∑—É –ø—Ä–∏–º–µ–Ω—è–µ–º
      if (document.body) {
        document.body.classList.add('dark-mode');
      } else {
        // –ï—Å–ª–∏ body –ø–æ—è–≤–∏—Ç—Å—è –ø–æ–∑–∂–µ ‚Äî –ø—Ä–∏–º–µ–Ω–∏–º –∫ –Ω–µ–º—É —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
        new MutationObserver((mutations, observer) => {
          if (document.body) {
            document.body.classList.add('dark-mode');
            observer.disconnect();
          }
        }).observe(document.documentElement, { childList: true });
      }

      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–µ–ª–æ–π –≤—Å–ø—ã—à–∫–∏
      document.documentElement.style.backgroundColor = '#121212';
      document.body?.style && (document.body.style.backgroundColor = '#121212');
      document.body?.style && (document.body.style.color = '#e0e0e0');
    } else {
      document.documentElement.classList.remove('dark-mode-html');
      document.body?.classList.remove('dark-mode');
      document.documentElement.style.backgroundColor = '#f8f9fa';
      document.body?.style && (document.body.style.backgroundColor = '#f8f9fa');
      document.body?.style && (document.body.style.color = '#212529');
    }
  } catch(e) {}
})();
  </script>

  <!-- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º—ã -->
  <meta name="color-scheme" content="dark light">

  <!-- CSS –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">

  {% block head %}{% endblock %}
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid px-3">
      <a class="navbar-brand">–¢–æ—Ä–≥–æ–≤—ã–π –∂—É—Ä–Ω–∞–ª</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="{{ url_for('trades.index') }}">–ñ—É—Ä–Ω–∞–ª</a></li>
          <li class="nav-item"><a class="nav-link" href="{{ url_for('profile.profile') }}">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
          <li class="nav-item"><a class="nav-link" href="{{ url_for('tasks.task_list') }}">–ó–∞–¥–∞—á–∏</a></li>
          <li class="nav-item"><a class="nav-link" href="{{ url_for('ai.ai_home') }}">AI –ü–æ–º–æ—â–Ω–∏–∫</a></li>
        </ul>
        <button id="toggle-theme" class="btn btn-sm btn-outline-light ms-auto">üåô</button>
      </div>
    </div>
  </nav>

  <main>
    {% block content %}{% endblock %}
  </main>
<script>
  document.addEventListener('DOMContentLoaded', () => {
      const toggleBtn = document.getElementById('toggle-theme');
      if (!toggleBtn) return;

      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∫–æ–Ω–∫—É –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–∫—É—â–µ–π —Ç–µ–º–æ–π
      toggleBtn.textContent = document.body.classList.contains('dark-mode') ? '‚òÄÔ∏è' : 'üåô';

      toggleBtn.addEventListener('click', () => {
        const isDark = document.body.classList.toggle('dark-mode');
        document.documentElement.classList.toggle('dark-mode-html', isDark);
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
        toggleBtn.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';

        // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ç–µ–º—ã
        if (window.renderCharts) window.renderCharts();
      });
    });
</script>
</body>
</html>
